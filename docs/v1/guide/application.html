
<!DOCTYPE html>
<html lang="en">
    <head>

    <title>CatLib Core — CatLib</title>
    <meta charset="utf-8">
    <meta name="description" content="CatLib Unity Framework.">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <link rel="stylesheet" href="/css/page.css">

    <script src="/js/vue.js"></script>
    <script src="/js/jquery.js"></script>
    </head>

    <body>
        
            <nav class="nav">
    <div class="border">
        <img src="/images/logo.png" />
        <button class="hiden-in-phone">V0.8</button>
        <button id="btn-menu" class="hiden-in-pc">Menu</button>
        <ul class="nav-link hiden-in-phone">
            <!--li>
                <form id="search-form">
                    <input type="text" id="search-query" class="search-query">
                </form>
            </li!-->
            <li><a href="https://github.com/catlib/catlib" class="nav-link-li">Download</a></li>
            <li><a href="/v1/guide/use.html" class="nav-link-li">Case</a></li>
            <li><a href="/v1/guide/version.html" class="nav-link-li">Release Notes</a></li>
            <li><a href="/v1/guide/contribution.html" class="nav-link-li">Contribution</a></li>
            <li><a href="/v1/guide/index.html" class="nav-link-li">About</a></li>
            <li><a href="/" class="nav-link-li current">Index</a></li>
        </ul>
    </div>
</nav>

<div id="container" class="container clear">
    <section class="sidebar clearfix">
    <ul>
        
            
            
                <li><h3>Basis</h3></li>
            
            
            
            <li>
                <p><a href="/v1/guide/index.html" class="sidebar-link">Introduction</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/upgrade.html" class="sidebar-link">Upgrade Guide</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/version.html" class="sidebar-link">Release Notes</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/error.html" class="sidebar-link">Common mistakes</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/style.html" class="sidebar-link">Code Style</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/contribution.html" class="sidebar-link">Contribution</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/use.html" class="sidebar-link">Use case</a></p>
            </li>
        
            
            
            
                <li><h3>System Structure</h3></li>
            
            
            <li>
                <p><a href="/v1/guide/service-provider.html" class="sidebar-link">Service provider</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/container.html" class="sidebar-link">Container</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/application.html" class="sidebar-link current">CatLib Core</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/api.html" class="sidebar-link">API</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/facade.html" class="sidebar-link">Service facade</a></p>
            </li>
        
            
            
            
            
                <li><h3>Core Components</h3></li>
            
            <li>
                <p><a href="/v1/guide/config.html" class="sidebar-link">Configuration</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/routing.html" class="sidebar-link">Routing</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/stl.html" class="sidebar-link">Standard library</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/file-system.html" class="sidebar-link">File system</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/time.html" class="sidebar-link">Time</a></p>
            </li>
        
            
            
            
            
            <li>
                <p><a href="/v1/guide/timer.html" class="sidebar-link">Timer</a></p>
            </li>
        
    </ul>
</section>
    <article class="clearfix">
    <h2 id="CatLib-Core"><a href="#CatLib-Core" class="headerlink" title="CatLib Core"></a>CatLib Core</h2><blockquote>
<p>This article is translated by machine</p>
</blockquote>
<p><code>Application</code> is the core of the CatLib program and is the so-called program entry. The application loads the service provider and other necessary resources by booting. The application is only allowed to start one in general, and can only be started in the main thread.</p>
<h3 id="Start-the-process"><a href="#Start-the-process" class="headerlink" title="Start the process"></a>Start the process</h3><p><code>Start boot</code> -&gt; <code>initialize</code> -&gt; <code>finish</code></p>
<p>Boot boot is typically used to load a service provider, initial configuration, or some other resource, and do not generate any services through the framework during the boot process (unless you are familiar with the framework’s startup process), you can use an unregistered service.</p>
<h3 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h3><p>The CatLib configuration is divided into `initial configuration ‘and’ general configuration ‘.</p>
<p><code>Initial configuration</code> The configuration required for the service provider to start, the initial configuration must be completed before the framework is started.</p>
<p><code>General configuration</code> The configuration that is required for the user to use the functionality provided by the service provider.</p>
<h3 id="Initial-configuration"><a href="#Initial-configuration" class="headerlink" title="Initial configuration"></a>Initial configuration</h3><p>The initial configuration must be configured before the framework is initialized. The following is the initial configuration required by the CatLib core:</p>
<table>
<thead>
<tr>
<th>Configuration name</th>
<th style="text-align:center">Must</th>
<th style="text-align:center">Description (click to view details)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>env.debug</code></td>
<td style="text-align:center">No</td>
<td style="text-align:center"><a href="#Environment">Frame debug level</a></td>
</tr>
<tr>
<td><code>env.asset.path</code></td>
<td style="text-align:center">NO</td>
<td style="text-align:center"><a href="#Environment">Resource file path</a></td>
</tr>
</tbody>
</table>
<h3 id="From-scratch"><a href="#From-scratch" class="headerlink" title="From scratch"></a>From scratch</h3><p>Now we will start from scratch to start the catlib framework so that you can understand the framework to start the principle, in fact, in the real project we have to help you write the boot process.</p>
<p>First, we need to define a boot program, the boot program must inherit from the <code>IBootstrap</code> interface, we can in the boot process to register the service provider or perform other boot business. In general, we recommend that priority be given to the registration of service providers. Note that you can register the service provider only before initialization, and calling the <code>Register ()</code> once the frame is initialized will cause an exception.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GameBootstrap</span> : <span class="title">IBootstrap</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Bootstrap</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        App.Instance.Register(<span class="keyword">typeof</span>(CoreProvider));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Then we need an entry program for mounting with Unity and triggering the startup process. In the entry program, we only need to instance a CatLib application, and set the corresponding boot program (the boot program will be loaded according to the order of the order.) Finally, the implementation of initialization.</p>
<blockquote>
<p>Note that if you are using <code>CatLib.dll</code> there will be building cross-assembly issues, you need to provide the<code>OnFindType ()</code>method to help the framework get the current assembly type.</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span> : <span class="title">MonoBehaviour</span> </div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">var</span> application = <span class="keyword">new</span> Application(<span class="keyword">this</span>);</div><div class="line">        application.OnFindType((t) =&gt; Type.GetType(t));</div><div class="line">        application.Bootstrap(<span class="keyword">new</span> Type[]&#123; <span class="keyword">typeof</span>(GameBootstrap) &#125;);</div><div class="line">        application.Init(()=&gt;</div><div class="line">        &#123;</div><div class="line">            <span class="comment">// 框架启动完成</span></div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Start-with-CatLib-Unity"><a href="#Start-with-CatLib-Unity" class="headerlink" title="Start with CatLib.Unity"></a>Start with CatLib.Unity</h3><p>In addition to the program described above, CatLib has prepared the boot program for the developer, and in the CatLib.Unity project you can configure the <code>Providers.cs</code> file to set the service provider for the framework.</p>
<p>CatLib.Unity default user code entry in the <code>Main.cs</code> file, of course, you can also use the routing tag to specify the boot entry (which requires you to delete the Main.cs file, in fact, the main.cs entry is completed by routing of).</p>
<p>Through the route to mark the conventional configuration entry, the regular configuration of the uri fixed to <code>bootstrap://config</code><br>Through the route to mark the start entry, the import uri fixed to <code>bootstrap://start</code>:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">[<span class="meta">Routed</span>]</div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Main</span></div><div class="line">&#123;</div><div class="line">    [<span class="meta">Routed(<span class="meta-string">"bootstrap://config"</span>)</span>]</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Config</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">//todo: config code here</span></div><div class="line">        Debug.Log(<span class="string">"config code here!"</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    [<span class="meta">Routed(<span class="meta-string">"bootstrap://start"</span>)</span>]</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Bootstrap</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">//todo: user code here</span></div><div class="line">        Debug.Log(<span class="string">"hello world! user code here!"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Main-thread-call"><a href="#Main-thread-call" class="headerlink" title="Main thread call"></a>Main thread call</h3><p>The CatLib core provides the ability of subroutine code block scheduling to perform the main thread. This is very common in the game system.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">App.Instance.MainThread(()=&gt;</div><div class="line">&#123;</div><div class="line">    <span class="comment">//The code block executed in the main thread</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Of course, you can also use <code>IsMainThread</code> to determine whether it is in the main thread.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> isMainThread = App.Instance.IsMainThread;</div></pre></td></tr></table></figure>
<h3 id="Mount-execution"><a href="#Mount-execution" class="headerlink" title="Mount execution"></a>Mount execution</h3><p>Mount execution allows you to inherit from the part of <code>MonoBehaviour</code> with part of<code>MonoBehaviour</code> ‘s ability</p>
<p>You need to achieve any one of the enhanced interface can be mounted, you can achieve the enhanced interface: <code>IUpdate</code>,<code>ILateUpdate</code>, <code>IDestroy</code></p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Element</span> : <span class="title">IUpdate</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">//todo</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> ele = <span class="keyword">new</span> Element();</div><div class="line">App.Instance.Attach(ele);</div></pre></td></tr></table></figure>
<p>An object can only be mounted once, but you can uninstall the mounted object by uninstalling it:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">App.Instance.Detach(ele);</div></pre></td></tr></table></figure>
<p>In addition to the manual mount, if you have bound the service to the container and the binding type is singleton binding, then once you have implemented the enhanced interface, the framework will automatically help you mount the execution, and when you release Will also be automatically uninstalled.</p>
<blockquote>
<p>Note that only when your service is a single case, to achieve the enhanced interface, and is generated through the container, will automatically mount (if your own <code>new</code> object will not automatically mount Oh)</p>
</blockquote>
<h3 id="Synergy"><a href="#Synergy" class="headerlink" title="Synergy"></a>Synergy</h3><p>CatLib allows classes that are not inherited from <code>MonoBehaviour</code> to start a collaborative program through this interface.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">App.Instance.StartCoroutine(<span class="comment">/* todo: 你的协同函数 */</span>);</div></pre></td></tr></table></figure>
<h3 id="Priority"><a href="#Priority" class="headerlink" title="Priority"></a>Priority</h3><p>All of the enhanced interfaces of CatLib support the priority feature. You can use <code>[Priority ()]</code> to define the priority.</p>
<p>Definition: The lower the priority value in CatLib, the more priority.</p>
<blockquote>
<p>If other components also use the priority then they also follow the definition of CatLib priority.</p>
</blockquote>
<h3 id="Global-event"><a href="#Global-event" class="headerlink" title="Global event"></a>Global event</h3><p>CatLib core provides a global event system, you only need a simple API can be called.</p>
<h4 id="Trigger-a-global-event"><a href="#Trigger-a-global-event" class="headerlink" title="Trigger a global event"></a><strong>Trigger a global event</strong></h4><figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">App.Instance.Trigger(<span class="string">"event"</span>);</div></pre></td></tr></table></figure>
<h4 id="Listen-to-global-events"><a href="#Listen-to-global-events" class="headerlink" title="Listen to global events"></a><strong>Listen to global events</strong></h4><p>When you listen to a global event, you are allowed to pass in the number of triggers. If you do not have an incoming message, the event is always valid. If the trigger is reached, the event is automatically revoked.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">App.Instance.On(<span class="string">"event"</span> , (sender , e)=&gt;</div><div class="line">&#123;</div><div class="line">    <span class="comment">// Accept the event</span></div><div class="line">&#125;, <span class="number">10</span>)</div></pre></td></tr></table></figure>
<h4 id="Revoke-the-global-event"><a href="#Revoke-the-global-event" class="headerlink" title="Revoke the global event"></a><strong>Revoke the global event</strong></h4><figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = App.Instance.On(<span class="string">"event"</span> , (sender , e)=&gt;</div><div class="line">&#123;</div><div class="line">    <span class="comment">// Accept the event</span></div><div class="line">&#125;);</div><div class="line">handler.Cancel();</div></pre></td></tr></table></figure>
<h4 id="Listen-to-a-global-event"><a href="#Listen-to-a-global-event" class="headerlink" title="Listen to a global event"></a><strong>Listen to a global event</strong></h4><figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = App.Instance.One(<span class="string">"event"</span> , (sender , e)=&gt;</div><div class="line">&#123;</div><div class="line">    <span class="comment">// Accept the event</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="Intra-procedural-GUID"><a href="#Intra-procedural-GUID" class="headerlink" title="Intra-procedural GUID"></a>Intra-procedural GUID</h3><p>The CatLib core provides the only GUID to get the current core instance.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> guid = App.Instance.GetGuid();</div></pre></td></tr></table></figure>
<h3 id="Get-the-CatLib-version-number"><a href="#Get-the-CatLib-version-number" class="headerlink" title="Get the CatLib version number"></a>Get the CatLib version number</h3><p>You can get the current CatLib core version number with <code>Version</code>.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> version = App.Instance.Version;</div></pre></td></tr></table></figure>
<h3 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h3><p>You can get environmental information via <code>IEnv</code> ‘s.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> env = App.Instance.Make&lt;IEnv&gt;();</div></pre></td></tr></table></figure>
<h4 id="SetAssetPath"><a href="#SetAssetPath" class="headerlink" title="SetAssetPath"></a><strong>SetAssetPath</strong></h4><p>You can set the resource path by <code>SetAssetPath</code>, and note that the resource path must be written.</p>
<ul>
<li>If the incoming value is <code>null</code> or` empty string ‘, it is not considered as a developer manually.</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">env.SetAssetPath(UnityEngine.Application.PersistentDataPath);</div></pre></td></tr></table></figure>
<h4 id="AssetPath"><a href="#AssetPath" class="headerlink" title="AssetPath"></a><strong>AssetPath</strong></h4><p>Gets the set resource path. `Default ‘</p>
<p>In editor mode:</p>
<ul>
<li><code>Production environment</code> for : <code>UnityEngine.Application.PersistentDataPath</code></li>
<li><code>Emulation Environment</code> for : <code>StreamingAssets</code>文件夹</li>
<li><code>Developer mode</code> for : <code>UnityEngine.Application.dataPath</code></li>
</ul>
<p>Out of editor mode:</p>
<ul>
<li>Automatically set to : <code>UnityEngine.Application.PersistentDataPath</code></li>
</ul>
<p>In any mode, if the developer manually sets <code>SetAssetPath</code>. Then always return to the developer settings, <code>AssetPath</code>.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> assetPath = env.AssetPath;</div></pre></td></tr></table></figure>
<h4 id="SetDebugLevel"><a href="#SetDebugLevel" class="headerlink" title="SetDebugLevel"></a><strong>SetDebugLevel</strong></h4><p>Set the debug level of CatLib. CatLib’s debug level is divided into:</p>
<ul>
<li><code>Prod</code>Production Environment</li>
<li><code>Staging</code>Simulation environment</li>
<li><code>Dev</code>Developer mode</li>
<li><code>Auto</code>Automatic mode, under the Unity editor for the developer mode, after the release for the production environment.</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line">env.SetDebugLevel(DebugLevels.Prod);</div></pre></td></tr></table></figure>
<h4 id="DebugLevel"><a href="#DebugLevel" class="headerlink" title="DebugLevel"></a><strong>DebugLevel</strong></h4><p>Get debug level.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> debugLevel = env.DebugLevel;</div></pre></td></tr></table></figure>
    <div class="footer">
        found mistake? Want to participate in editing?
        <a href="https://github.com/catlib/en.catlib.io/blob/master/src/v1/guide/application.md" target="_blank">
            Edit this page on Github!
        </a>
    </div>
</article>

<div class="sub-nav hiden-in-phone">
    <dl id="sub-nav">
        <dt>Content</dt>
        <dd v-for="(ele, index) in sub_nav">
           <a v-bind:href="ele.href">{{ ele.name }}</a>
        </dd>
    </dl>
</div> 
</div>

<footer>
    <div>
        <p>© Copyright 2017 catlib.io All Rights Reserved</p>
        <p>Meow meow, come and play meow ~</p>
    </div>
</footer>


<script>
var vm = new Vue({
    el : '#container',
    data: {
        sub_nav : [ ]
    },
    created:function(){
        var obj = [];
        $("article h3").each(function(){
            obj.push({name :  $(this).find("a").attr("title") , href : "#"+$(this).attr("id") });
        });

        this.sub_nav = obj;       
    }
});

var isShow = false;
$("nav").on("click","#btn-menu" , function(){

    if(!isShow){
        
        if($(document).scrollTop() > $(".sidebar").height() - 100){

            $('html, body').animate({scrollTop:0} , 300, "swing",function(){

                $(".sidebar").fadeIn();
                $(".container").animate({"left" : "15rem"}, 500,"swing");
            });
        }else{

                $(".sidebar").fadeIn();
                $(".container").animate({"left" : "15rem"}, 500,"swing");

        }

    }else{
        $(".sidebar").fadeOut();
        $(".container").animate({"left" : "0rem"}, 500,"swing");
    }
    isShow = !isShow;

});

$(".container").on("click" , "article" , function(){

    if(isShow){
        $(".sidebar").fadeOut();
        $(".container").animate({"left" : "0rem"}, 500,"swing");
        isShow = false;    
    }

});
</script>
        
    </body>
</html>